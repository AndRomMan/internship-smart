{"version":3,"sources":["modal.js"],"names":["window","NodeList","prototype","forEach","Array","HTMLCollection","pageBody","document","querySelector","callbackSection","callbackBtn","modalCloseBtn","inputFocused","overlayLinks","querySelectorAll","overlayBtns","overlayInputs","overlayTextareas","MODAL_OVERLAY","MODAL_WIN","BODY_OVERFLOW","OUT_OF_TAB","setTabindex","elements","index","activeElement","classList","contains","setAttribute","removeTabindex","removeAttribute","setOverlayTabindex","setActiveTabindex","activeBtns","activeInputs","activeTextareas","setInitialTabindex","escapeHAndler","evt","code","preventDefault","removeModalState","callbackSectionClickHandler","element","target","addModalState","addEventListener","add","modalCloseBtnClickHandler","focus","removeEventListener","remove","callbackBtnClickHandler"],"mappings":"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","sourcesContent":["// modal.js\n'use strict';\n\n(function () {\n  // polyfill forEach for IE 11\n  if (window.NodeList && !NodeList.prototype.forEach) {\n    NodeList.prototype.forEach = Array.prototype.forEach;\n  }\n  if (window.HTMLCollection && !HTMLCollection.prototype.forEach) {\n    HTMLCollection.prototype.forEach = Array.prototype.forEach;\n  }\n\n  let pageBody = document.querySelector('body');\n  let callbackSection = document.querySelector('.callback');\n  let callbackBtn = document.querySelector('.header__btn');\n  let modalCloseBtn = document.querySelector('.form-wrapper__modal-close');\n  let inputFocused = document.querySelector('#username');\n\n  let overlayLinks = document.querySelectorAll('a');\n  let overlayBtns = document.querySelectorAll('button');\n  let overlayInputs = document.querySelectorAll('input');\n  let overlayTextareas = document.querySelectorAll('textarea');\n\n  const MODAL_OVERLAY = 'callback';\n  const MODAL_WIN = 'modal';\n  const BODY_OVERFLOW = 'body--overflow';\n  const OUT_OF_TAB = 'advantages-link';\n\n  function setTabindex(elements, index) {\n    elements.forEach(function (activeElement) {\n      if (activeElement.classList.contains(OUT_OF_TAB)) {\n        return;\n      } else {\n        activeElement.setAttribute('tabindex', '' + index);\n      }\n    });\n  }\n\n  function removeTabindex(elements) {\n    elements.forEach(function (activeElement) {\n      if (activeElement.classList.contains(OUT_OF_TAB)) {\n        return;\n      } else {\n        activeElement.removeAttribute('tabindex');\n      }\n    });\n  }\n\n  function setOverlayTabindex() {\n    [overlayLinks, overlayBtns, overlayInputs, overlayTextareas].forEach(function (elements) {\n      setTabindex(elements, -1);\n    });\n  }\n\n  function setActiveTabindex() {\n    let activeBtns = document.querySelectorAll('.modal button');\n    let activeInputs = document.querySelectorAll('.modal input');\n    let activeTextareas = document.querySelectorAll('.modal textarea');\n\n    [activeBtns, activeInputs, activeTextareas].forEach(function (elements) {\n      setTabindex(elements, 0);\n    });\n  }\n\n  function setInitialTabindex() {\n    [overlayLinks, overlayBtns, overlayInputs, overlayTextareas].forEach(function (elements) {\n      removeTabindex(elements);\n    });\n  }\n\n  function escapeHAndler(evt) {\n    if (evt.code === 'Escape') {\n      evt.preventDefault();\n      removeModalState();\n    }\n  }\n\n  function callbackSectionClickHandler(evt) {\n    let element = evt.target;\n\n    if (element.classList.contains(MODAL_OVERLAY)) {\n      removeModalState();\n    } else {\n      return;\n    }\n  }\n\n  function addModalState() {\n    window.addEventListener('keydown', escapeHAndler);\n    pageBody.classList.add(BODY_OVERFLOW);\n    callbackSection.classList.add(MODAL_WIN);\n\n    if (callbackSection) {\n      callbackSection.addEventListener('click', callbackSectionClickHandler);\n    }\n\n    if (modalCloseBtn) {\n      modalCloseBtn.addEventListener('click', modalCloseBtnClickHandler);\n    }\n\n    setOverlayTabindex();\n\n    setActiveTabindex();\n\n    inputFocused.focus();\n  }\n\n  function removeModalState() {\n    window.removeEventListener('keydown', escapeHAndler);\n    pageBody.classList.remove(BODY_OVERFLOW);\n    callbackSection.classList.remove(MODAL_WIN);\n\n    if (callbackSection) {\n      callbackSection.removeEventListener('click', callbackSectionClickHandler);\n    }\n\n    if (modalCloseBtn) {\n      modalCloseBtn.removeEventListener('click', modalCloseBtnClickHandler);\n    }\n\n    setInitialTabindex();\n  }\n\n  function callbackBtnClickHandler() {\n    addModalState();\n  }\n\n  function modalCloseBtnClickHandler() {\n    removeModalState();\n  }\n\n  if (callbackBtn) {\n    callbackBtn.addEventListener('click', callbackBtnClickHandler);\n  }\n})();\n"],"file":"modal.js"}